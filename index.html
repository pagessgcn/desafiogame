<script>
    // Defini√ß√£o dos Dilemas de RSAC (seu DILEMAS original)
    const DILEMAS = [
        // ... (Seus 10 dilemas originais aqui) ...
        {
            tema: "1. Res√≠duos e Custos (Planeta/Lucro)",
            pergunta: "Sua empresa precisa reduzir custos para manter a competitividade. Qual decis√£o voc√™ toma em rela√ß√£o ao descarte de res√≠duos industriais?",
            opcoes: [
                {
                    texto: "Op√ß√£o A (RSAC Positiva): Investir em Economia Circular (reciclagem e separa√ß√£o), absorvendo o custo inicial.",
                    impacto: { planeta: 15, pessoas: 5, lucro: -12 }, 
                    fato: "FATO RSAC: <span class='bold'>Economia Circular</span> (Op√ß√£o A) √© o melhor a longo prazo, mas exige investimento inicial. O custo de descarte irregular (Op√ß√£o C) sempre volta como multa ou crise de reputa√ß√£o."
                },
                {
                    texto: "Op√ß√£o B (Neutro): Manter o descarte atual em aterro sanit√°rio.",
                    impacto: { planeta: -5, pessoas: 0, lucro: 5 },
                    fato: "FATO RSAC: Aterros s√£o uma solu√ß√£o tempor√°ria e n√£o sustent√°vel. N√£o resolve o problema e pode gerar custos futuros com taxas ambientais."
                },
                {
                    texto: "Op√ß√£o C (RSAC Negativa): Usar um servi√ßo de descarte irregular, por√©m mais barato, para cortar custos.",
                    impacto: { planeta: -20, pessoas: -10, lucro: 15 },
                    fato: "FATO RSAC: Descarte irregular √© crime ambiental, destr√≥i o pilar Planeta e, se descoberto, causa fal√™ncia e pris√£o."
                }
            ]
        },
        // ... (resto dos dilemas) ...
    ]; // Fechamento do Array DILEMAS

    // Estado do Jogo
    let status = {
        planeta: 100,
        pessoas: 100,
        lucro: 100,
        turno: 1,
        vitoria: 10,
        minimoParaVencer: 75,
        gameActive: false
    };

    // Vari√°veis de L√≥gica
    let DILEMAS_ORDENADOS = []; 
    let INDICE_ATUAL_DILEMA = 0; 
    
    // Refer√™ncias aos Elementos da Interface
    const elements = {
        planetaBar: document.getElementById('planeta-bar'),
        pessoasBar: document.getElementById('pessoas-bar'),
        lucroBar: document.getElementById('lucro-bar'),
        planetaValue: document.getElementById('planeta-value'),
        pessoasValue: document.getElementById('pessoas-value'),
        lucroValue: document.getElementById('lucro-value'),
        turnInfo: document.getElementById('turn-info'),
        cardContainer: document.getElementById('card-container'),
        feedbackDiv: document.getElementById('feedback'),
        gameOverScreen: document.getElementById('game-over-screen'),
        winScreen: document.getElementById('win-screen'),
        gameArea: document.getElementById('game-area')
    };
    
    // --- Fun√ß√£o para embaralhar um array (Algoritmo Fisher-Yates) ---
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // Defini√ß√£o de Eventos Aleat√≥rios (Feedback da Comunidade)
    const EVENTOS_ALEATORIOS = {
        planetaBaixo: [
            { texto: "üö® <span class='bold'>EVENTO: Crise Ambiental!</span> Not√≠cias sobre polui√ß√£o h√≠drica na √°rea da f√°brica. A reputa√ß√£o cai e h√° custos de remedia√ß√£o. (-10 Lucro, -10 Pessoas).", impacto: { lucro: -10, pessoas: -10, planeta: 0 } },
            { texto: "‚ö†Ô∏è <span class='bold'>EVENTO: Multa Ambiental Pesada!</span> O governo imp√µe uma multa por m√° gest√£o de res√≠duos. (-15 Lucro).", impacto: { lucro: -15, pessoas: 0, planeta: 0 } },
        ],
        pessoasBaixo: [
            { texto: "üì¢ <span class='bold'>EVENTO: Greve Geral!</span> Funcion√°rios param a produ√ß√£o devido √†s m√°s condi√ß√µes de trabalho. (-15 Lucro, -5 Pessoas).", impacto: { lucro: -15, pessoas: -5, planeta: 0 } },
            { texto: "üò† <span class='bold'>EVENTO: Protesto da Comunidade!</span> Moradores protestam contra a empresa. A reputa√ß√£o e confian√ßa caem. (-15 Pessoas).", impacto: { lucro: 0, pessoas: -15, planeta: 0 } },
        ],
        lucroBaixo: [
            { texto: "üìâ <span class='bold'>EVENTO: Queda no Investimento!</span> Acionistas preocupados com a transpar√™ncia e desempenho reduzem o capital investido. (-10 Lucro).", impacto: { lucro: -10, pessoas: 0, planeta: 0 } },
            { texto: "‚ùå <span class='bold'>EVENTO: Dificuldade de Empr√©stimo!</span> Bancos negam cr√©dito devido ao baixo desempenho financeiro. (-5 Lucro).", impacto: { lucro: -5, pessoas: 0, planeta: 0 } },
        ],
        todosAltos: [
            { texto: "üèÜ <span class='bold'>EVENTO: Pr√™mio de Sustentabilidade!</span> Cobertura de m√≠dia positiva e b√¥nus nas vendas. (+10 Lucro, +5 Pessoas, +5 Planeta).", impacto: { lucro: 10, pessoas: 5, planeta: 5 } },
            { texto: "ü§ù <span class='bold'>EVENTO: Lealdade do Consumidor!</span> Consumidores preferem marcas √©ticas, gerando aumento de vendas. (+10 Lucro, +10 Pessoas).", impacto: { lucro: 10, pessoas: 10, planeta: 0 } },
        ],
    };

    // --- Fun√ß√µes de L√≥gica do Jogo (continuando) ---

    function updateUI() {
        // [C√ìDIGO DA FUN√á√ÉO updateUI ORIGINAL]
        ['planeta', 'pessoas', 'lucro'].forEach(key => {
            const value = Math.max(0, Math.min(100, status[key]));
            const barElement = elements[`${key}Bar`];
            const valueElement = elements[`${key}Value`];
            
            barElement.style.width = `${value}%`;
            valueElement.textContent = `${value.toFixed(0)}%`;

            const barContainer = barElement.parentElement.parentElement;
            if (value < 25) {
                barElement.classList.add(`low-${key}`);
                barContainer.style.borderColor = '#e74c3c';
            } else {
                barElement.classList.remove(`low-${key}`);
                barContainer.style.borderColor = '';
            }
        });

        elements.turnInfo.textContent = `Turno ${status.turno} / ${status.vitoria}`;
    }

    function clamp(value) {
        return Math.max(0, Math.min(100, value));
    }

    function applyImpact(impact) {
        status.planeta = clamp(status.planeta + (impact.planeta || 0));
        status.pessoas = clamp(status.pessoas + (impact.pessoas || 0));
        status.lucro = clamp(status.lucro + (impact.lucro || 0));
    }
    
    function checkGameOver() {
        // [C√ìDIGO DA FUN√á√ÉO checkGameOver ORIGINAL]
        if (status.planeta <= status.minimoParaVencer || status.pessoas <= status.minimoParaVencer || status.lucro <= status.minimoParaVencer) {
            status.gameActive = false;
            elements.cardContainer.style.display = 'none';
            elements.feedbackDiv.style.display = 'none';

            let msg = `<h2>üò≠ Fim de Jogo!</h2>`;
            if (status.planeta <= status.minimoParaVencer) {
                msg += `<p>O pilar <span class='bold'>PLANETA (${status.planeta}%)</span> caiu abaixo do m√≠nimo (${status.minimoParaVencer}%). Sua empresa foi multada e fechada.</p>`;
            } else if (status.pessoas <= status.minimoParaVencer) {
                msg += `<p>O pilar <span class='bold'>PESSOAS (${status.pessoas}%)</span> caiu abaixo do m√≠nimo (${status.minimoParaVencer}%). Crises sociais e greves inviabilizaram a opera√ß√£o.</p>`;
            } else if (status.lucro <= status.minimoParaVencer) {
                msg += `<p>O pilar <span class='bold'>LUCRO (${status.lucro}%)</span> caiu abaixo do m√≠nimo (${status.minimoParaVencer}%). A empresa faliu devido a altos custos ou baixo retorno.</p>`;
            }
            msg += `<button onclick="window.location.reload()" class="next-turn-button" style="background-color: #c0392b;">Recome√ßar Jogo</button>`;
            elements.gameOverScreen.innerHTML = msg;
            elements.gameOverScreen.style.display = 'block';
            return true;
        }

        if (status.turno > status.vitoria) {
            status.gameActive = false;
            elements.cardContainer.style.display = 'none';
            elements.feedbackDiv.style.display = 'none';
            
            let msg = `<h2>üéâ Vit√≥ria! Parab√©ns!</h2>`;
            msg += `<p>Voc√™ sobreviveu por ${status.vitoria} turnos e manteve o <span class='bold'>Triple Bottom Line</span> acima de ${status.minimoParaVencer}%. Seu legado de sustentabilidade est√° garantido!</p>`;
            msg += `<p>Planeta: ${status.planeta}%, Pessoas: ${status.pessoas}%, Lucro: ${status.lucro}%</p>`;
            msg += `<button onclick="window.location.reload()" class="next-turn-button" style="background-color: #27ae60;">Jogar Novamente</button>`;
            elements.winScreen.innerHTML = msg;
            elements.winScreen.style.display = 'block';
            return true;
        }

        return false;
    }

    function checkRandomEvent() {
        // [C√ìDIGO DA FUN√á√ÉO checkRandomEvent ORIGINAL]
        const baixo = status.minimoParaVencer + 15; // Define o limiar para 'baixo' como 90% (75+15) para tornar o jogo mais desafiador.
        const alto = status.minimoParaVencer + 20; // Define o limiar para 'alto' como 95% (75+20)

        const isPlanetaLow = status.planeta < baixo;
        const isPessoasLow = status.pessoas < baixo;
        const isLucroLow = status.lucro < baixo;
        const isAllHigh = status.planeta > alto && status.pessoas > alto && status.lucro > alto;

        let eventMessage = "Tudo Calmo. Nenhum evento aleat√≥rio neste turno.";
        let eventOccurred = false;

        if (isAllHigh && Math.random() < 0.3) { // 30% de chance de evento positivo se todos estiverem altos
            const event = EVENTOS_ALEATORIOS.todosAltos[Math.floor(Math.random() * EVENTOS_ALEATORIOS.todosAltos.length)];
            applyImpact(event.impact);
            eventMessage = event.texto;
            eventOccurred = true;
        } else if (isPlanetaLow && Math.random() < 0.5) { // 50% de chance de evento negativo se Planeta estiver baixo
            const event = EVENTOS_ALEATORIOS.planetaBaixo[Math.floor(Math.random() * EVENTOS_ALEATORIOS.planetaBaixo.length)];
            applyImpact(event.impact);
            eventMessage = event.texto;
            eventOccurred = true;
        } else if (isPessoasLow && Math.random() < 0.5) { // 50% de chance de evento negativo se Pessoas estiver baixo
            const event = EVENTOS_ALEATORIOS.pessoasBaixo[Math.floor(Math.random() * EVENTOS_ALEATORIOS.pessoasBaixo.length)];
            applyImpact(event.impact);
            eventMessage = event.texto;
            eventOccurred = true;
        } else if (isLucroLow && Math.random() < 0.5) { // 50% de chance de evento negativo se Lucro estiver baixo
            const event = EVENTOS_ALEATORIOS.lucroBaixo[Math.floor(Math.random() * EVENTOS_ALEATORIOS.lucroBaixo.length)];
            applyImpact(event.impact);
            eventMessage = event.texto;
            eventOccurred = true;
        }

        elements.feedbackDiv.innerHTML = `<p><span class="bold">Feedback da Comunidade/Eventos:</span> ${eventMessage}</p>`;
        elements.feedbackDiv.style.display =

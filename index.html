<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio Triplo: Gestor Sustent√°vel (RSAC)</title>
    <style>
        /* CSS Embarcado para Leveza e Simplicidade */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            max-width: 900px;
            width: 100%;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
        }
        .indicators {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            gap: 15px;
        }
        .indicator-bar {
            width: 30%;
            text-align: center;
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .indicator-bar h3 {
            margin-top: 0;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .bar-container {
            height: 10px;
            background: #bdc3c7;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
        }
        .bar {
            height: 100%;
            transition: width 0.5s ease-in-out, background-color 0.5s ease-in-out;
        }
        .planeta .bar { background-color: #2ecc71; } /* Green */
        .pessoas .bar { background-color: #3498db; } /* Blue */
        .lucro .bar { background-color: #f39c12; } /* Orange */

        /* Red for low status */
        .low-planeta { background-color: #e74c3c !important; }
        .low-pessoas { background-color: #e74c3c !important; }
        .low-lucro { background-color: #e74c3c !important; }

        .game-area {
            border-top: 1px solid #ddd;
            padding-top: 25px;
        }
        .turn-info {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .card-container {
            border: 2px solid #34495e;
            border-radius: 10px;
            padding: 20px;
            background: #fdfdfd;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        .card-container h2 {
            margin-top: 0;
            color: #34495e;
        }
        .option-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
            text-align: left;
        }
        .option-button:hover {
            background-color: #2980b9;
        }
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #ecf0f1;
            border-left: 5px solid #3498db;
        }
        .feedback p {
            margin: 5px 0;
        }
        .educational-fact {
            font-style: italic;
            color: #2c3e50;
            margin-top: 10px;
            border-top: 1px dashed #ccc;
            padding-top: 10px;
        }
        .game-over-screen, .win-screen {
            text-align: center;
            padding: 50px;
            background: #e74c3c;
            color: white;
            border-radius: 10px;
            margin-top: 20px;
        }
        .win-screen {
            background: #27ae60;
        }
        .next-turn-button {
            display: block;
            width: 50%;
            margin: 20px auto;
            padding: 15px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }
        .next-turn-button:hover {
            background-color: #2ecc71;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Desafio Triplo: Sustentabilidade e Neg√≥cios üí∞üåçüë•</h1>
        <p style="text-align: center; margin-bottom: 25px; font-weight: 500;">
            Assuma o papel de Gestor de Sustentabilidade. Seu objetivo √© sobreviver por **10 Turnos** mantendo as tr√™s barras do **Triple Bottom Line (Pessoas, Planeta, Lucro)** acima de **75%**.
        </p>

        <div class="indicators">
            <div class="indicator-bar planeta">
                <h3>üü¢ Planeta (Ambiental)</h3>
                <div class="bar-container"><div id="planeta-bar" class="bar" style="width: 100%;"></div></div>
                <p id="planeta-value">100%</p>
            </div>
            <div class="indicator-bar pessoas">
                <h3>üîµ Pessoas (Social)</h3>
                <div class="bar-container"><div id="pessoas-bar" class="bar" style="width: 100%;"></div></div>
                <p id="pessoas-value">100%</p>
            </div>
            <div class="indicator-bar lucro">
                <h3>üí∞ Lucro (Econ√¥mico/Governan√ßa)</h3>
                <div class="bar-container"><div id="lucro-bar" class="bar" style="width: 100%;"></div></div>
                <p id="lucro-value">100%</p>
            </div>
        </div>
        
        <div id="game-area" class="game-area">
            <div id="turn-info" class="turn-info">Turno 1 / 10</div>
            
            <div id="card-container" class="card-container">
                <h2>Aguardando In√≠cio...</h2>
                <p style="text-align: center;">Clique em **Come√ßar Jogo** para iniciar o primeiro turno.</p>
                <button onclick="startGame()" class="next-turn-button">Come√ßar Jogo</button>
            </div>

            <div id="feedback" class="feedback" style="display:none;"></div>
        </div>

        <div id="game-over-screen" class="game-over-screen" style="display:none;"></div>
        <div id="win-screen" class="win-screen" style="display:none;"></div>

    </div>

    <script>
        // Defini√ß√£o dos Dilemas de RSAC (As Cartas de Decis√£o)
        const DILEMAS = [
            {
                tema: "1. Res√≠duos e Custos (Planeta/Lucro)",
                pergunta: "Sua empresa precisa reduzir custos para manter a competitividade. Qual decis√£o voc√™ toma em rela√ß√£o ao descarte de res√≠duos industriais?",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Investir em Economia Circular (reciclagem e separa√ß√£o), absorvendo o custo inicial.",
                        impacto: { planeta: 15, pessoas: 5, lucro: -12 }, 
                        fato: "FATO RSAC: **Economia Circular** (Op√ß√£o A) √© o melhor a longo prazo, mas exige investimento inicial. O custo de descarte irregular (Op√ß√£o C) sempre volta como multa ou crise de reputa√ß√£o."
                    },
                    {
                        texto: "Op√ß√£o B (Neutro): Manter o descarte atual em aterro sanit√°rio.",
                        impacto: { planeta: -5, pessoas: 0, lucro: 5 },
                        fato: "FATO RSAC: Aterros s√£o uma solu√ß√£o tempor√°ria e n√£o sustent√°vel. N√£o resolve o problema e pode gerar custos futuros com taxas ambientais."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Usar um servi√ßo de descarte irregular, por√©m mais barato, para cortar custos.",
                        impacto: { planeta: -20, pessoas: -10, lucro: 15 },
                        fato: "FATO RSAC: Descarte irregular √© crime ambiental, destr√≥i o pilar Planeta e, se descoberto, causa fal√™ncia e pris√£o."
                    }
                ]
            },
            {
                tema: "2. Sal√°rio e Moral (Pessoas/Lucro)",
                pergunta: "A empresa teve lucro inesperado. Acionistas pedem dividendo m√°ximo, mas funcion√°rios clamam por melhores sal√°rios e benef√≠cios.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Distribuir b√¥nus e investir em forma√ß√£o profissional para todos.",
                        impacto: { planeta: 0, pessoas: 18, lucro: -15 }, 
                        fato: "FATO RSAC: **Capital Humano** √© o ativo mais importante. A satisfa√ß√£o e a forma√ß√£o dos funcion√°rios (Op√ß√£o A) aumentam a produtividade e a reten√ß√£o, superando o custo a longo prazo."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Aumentar o dividendo, mas dar um aumento m√≠nimo apenas para a gest√£o.",
                        impacto: { planeta: 0, pessoas: -5, lucro: 10 }, 
                        fato: "FATO RSAC: Desigualdade interna gera desmotiva√ß√£o, queda na produtividade e perda de talentos. Lucros n√£o compartilhados afetam o pilar Pessoas."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Maximizar o dividendo para acionistas e cortar o or√ßamento de benef√≠cios.",
                        impacto: { planeta: 0, pessoas: -25, lucro: 15 }, 
                        fato: "FATO RSAC: Ignorar o pilar Pessoas (Op√ß√£o C) leva a greves, queda abrupta da moral e perda maci√ßa de talentos, afetando a qualidade e, logo, o Lucro."
                    }
                ]
            },
            {
                tema: "3. √âtica e Fornecedores (Pessoas/Planeta)",
                pergunta: "Uma ONG denuncia que um fornecedor vital usa m√£o de obra question√°vel e polui rios. Voc√™ precisa de mat√©ria-prima urgentemente.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Mudar imediatamente para um fornecedor certificado, mesmo que custe mais caro.",
                        impacto: { planeta: 10, pessoas: 15, lucro: -12 }, 
                        fato: "FATO RSAC: A **√âtica na Cadeia de Valor** (Op√ß√£o A) √© crucial. A empresa √© correspons√°vel pelas a√ß√µes de seus fornecedores. A mudan√ßa elimina o risco de esc√¢ndalo."
                    },
                    {
                        texto: "Op√ß√£o B (Neutro): Emitir uma nota negando e prometer uma auditoria interna lenta.",
                        impacto: { planeta: -5, pessoas: -5, lucro: 0 }, 
                        fato: "FATO RSAC: Prometer e n√£o agir (Op√ß√£o B) √© considerado **Greenwashing** ou **Socialwashing**. Atrasar a solu√ß√£o mant√©m o risco e afeta a credibilidade da marca."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Ignorar o relat√≥rio e fechar o pedido de mat√©ria-prima, garantindo o lucro imediato.",
                        impacto: { planeta: -15, pessoas: -20, lucro: 10 }, 
                        fato: "FATO RSAC: Ocultar ou ignorar viola√ß√µes √©ticas (Op√ß√£o C) pode destruir a reputa√ß√£o da empresa, levar a boicotes e processos judiciais."
                    }
                ]
            },
            {
                tema: "4. Transi√ß√£o Energ√©tica (Planeta/Lucro)",
                pergunta: "Para reduzir sua Pegada de Carbono, voc√™ deve instalar pain√©is solares (investimento de 8% do lucro) ou continuar comprando energia da rede, que √© mais barata e suja.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Instalar pain√©is solares, bancando o custo inicial.",
                        impacto: { planeta: 18, pessoas: 0, lucro: -10 }, 
                        fato: "FATO RSAC: A **Transi√ß√£o Energ√©tica** (Op√ß√£o A) √© um investimento de longo prazo. O custo inicial √© alto, mas reduz a pegada de carbono e os custos operacionais futuros."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Comprar cr√©ditos de carbono no mercado internacional.",
                        impacto: { planeta: 5, pessoas: 0, lucro: -5 }, 
                        fato: "FATO RSAC: Cr√©ditos de carbono (Op√ß√£o B) compensam as emiss√µes, mas n√£o as reduzem. √â uma solu√ß√£o mais fraca que a descarboniza√ß√£o direta."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Continuar usando energia barata e suja.",
                        impacto: { planeta: -15, pessoas: 0, lucro: 10 }, 
                        fato: "FATO RSAC: A depend√™ncia de energia suja (Op√ß√£o C) √© um risco de mercado crescente devido a impostos sobre carbono e a instabilidade geopol√≠tica."
                    }
                ]
            },
            {
                tema: "5. Comunidade Local (Pessoas/Lucro)",
                pergunta: "A comunidade local (vizinha √† f√°brica) pede financiamento para construir uma creche. Investir o valor desviaria 5% do or√ßamento de Marketing.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Financiar a creche como um Investimento Social estrat√©gico.",
                        impacto: { planeta: 0, pessoas: 15, lucro: -12 }, 
                        fato: "FATO RSAC: **Investimento Social Estrat√©gico** (Op√ß√£o A) aumenta a 'Licen√ßa Social para Operar', gera boa vontade e reputa√ß√£o, o que indiretamente impulsiona o Lucro futuro."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Fazer uma pequena doa√ß√£o pontual (Filantropia) para ajudar.",
                        impacto: { planeta: 0, pessoas: 5, lucro: -5 }, 
                        fato: "FATO RSAC: Filantropia (Op√ß√£o B) resolve um problema imediato, mas n√£o cria valor m√∫tuo de longo prazo entre a empresa e a comunidade."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Negar e focar todo o or√ßamento no Marketing tradicional.",
                        impacto: { planeta: 0, pessoas: -15, lucro: 10 }, 
                        fato: "FATO RSAC: Ignorar o clamor comunit√°rio (Op√ß√£o C) afeta a reputa√ß√£o, aumenta o risco de protestos e pode gerar atrito com autoridades locais."
                    }
                ]
            },
            {
                tema: "6. Diversidade e Inclus√£o (Pessoas)",
                pergunta: "Para aumentar a diversidade, voc√™ deve implementar um programa de mentoria e cotas, mas a √°rea de RH avisa que o processo de contrata√ß√£o ser√° mais lento e custoso.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Implementar o programa completo, absorvendo o custo (Pessoas e ESG).",
                        impacto: { planeta: 0, pessoas: 15, lucro: -10 }, 
                        fato: "FATO RSAC: A **Diversidade e Inclus√£o** (Op√ß√£o A) comprovadamente aumentam a inova√ß√£o e o desempenho financeiro no longo prazo, apesar do custo inicial de implementa√ß√£o."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Adotar apenas medidas de conscientiza√ß√£o online (custo baixo).",
                        impacto: { planeta: 0, pessoas: 5, lucro: -2 }, 
                        fato: "FATO RSAC: Conscientiza√ß√£o √© o primeiro passo, mas sem a√ß√£o concreta (Op√ß√£o B), a iniciativa pode ser vista como 'Socialwashing' superficial."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Manter o foco apenas no 'm√©rito' sem programas espec√≠ficos de inclus√£o.",
                        impacto: { planeta: 0, pessoas: -10, lucro: 5 }, 
                        fato: "FATO RSAC: O foco exclusivo no 'm√©rito' (Op√ß√£o C) perpetua a falta de diversidade, excluindo talentos e limitando a perspectiva do neg√≥cio."
                    }
                ]
            },
            {
                tema: "7. Lobby e Legisla√ß√£o (Governan√ßa/Planeta)",
                pergunta: "Um projeto de lei que limita severamente a polui√ß√£o est√° em vota√ß√£o. Voc√™ pode financiar um lobby para atrasar a lei ou apoiar a legisla√ß√£o publicamente.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Apoiar a Lei e adequar a empresa (RSAC).",
                        impacto: { planeta: 15, pessoas: 5, lucro: -15 }, 
                        fato: "FATO RSAC: Apoiar a legisla√ß√£o (Op√ß√£o A) cria um campo de atua√ß√£o justo, evita multas futuras e fortalece a reputa√ß√£o corporativa."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Financiar um lobby discreto para diluir a lei, mas sem ilegalidades.",
                        impacto: { planeta: -5, pessoas: 0, lucro: 5 }, 
                        fato: "FATO RSAC: O lobby √©tico (Op√ß√£o B) pode ser legal, mas √© visto com desconfian√ßa e coloca os interesses privados acima dos ambientais."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Financiar um lobby agressivo e ilegal para derrubar a lei.",
                        impacto: { planeta: -25, pessoas: -15, lucro: 15 }, 
                        fato: "FATO RSAC: O lobby ilegal (Op√ß√£o C) √© um risco catastr√≥fico de Governan√ßa. Se descoberto, resulta em esc√¢ndalo, multas e processos criminais."
                    }
                ]
            },
            {
                tema: "8. Marketing √âtico (Planeta/Pessoas)",
                pergunta: "A equipe de marketing quer lan√ßar uma campanha 'verde' baseada em uma √∫nica a√ß√£o ambiental pequena, gastando metade do seu lucro anual.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Bloquear a campanha e investir em a√ß√µes ambientais substanciais primeiro.",
                        impacto: { planeta: 10, pessoas: 5, lucro: -15 }, 
                        fato: "FATO RSAC: A√ß√£o real √© mais importante que propaganda. A Op√ß√£o A evita o **Greenwashing** e constr√≥i valor genu√≠no para o Planeta e a reputa√ß√£o (Pessoas)."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Lan√ßar a campanha 'verde' mesmo com dados fracos (Greenwashing).",
                        impacto: { planeta: -5, pessoas: -10, lucro: 10 }, 
                        fato: "FATO RSAC: **Greenwashing** (Op√ß√£o B) pode levar a processos legais por propaganda enganosa e destrui√ß√£o da confian√ßa do consumidor (Pessoas) se for desmascarado."
                    },
                    {
                        texto: "Op√ß√£o C (Alternativa Sustent√°vel): Mudar o or√ßamento da campanha para um projeto social tang√≠vel e mensur√°vel (ODS).",
                        impacto: { planeta: 5, pessoas: 10, lucro: -10 }, 
                        fato: "FATO RSAC: O foco em projetos sociais (Op√ß√£o C) alinhados aos ODS gera impacto positivo mensur√°vel e √© uma estrat√©gia de RSAC mais segura do que o Greenwashing."
                    }
                ]
            },
            {
                tema: "9. Crise e Transpar√™ncia (Governan√ßa/Pessoas)",
                pergunta: "Um erro na linha de produ√ß√£o causou um pequeno vazamento de produto. Se revelado, pode assustar investidores. Compliance exige transpar√™ncia total.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Revelar o erro imediatamente, assumir a culpa e apresentar um plano de corre√ß√£o.",
                        impacto: { planeta: 0, pessoas: 15, lucro: -12 }, 
                        fato: "FATO RSAC: A **Transpar√™ncia** (Op√ß√£o A) √© o pilar da Governan√ßa. Embora possa haver queda de Lucro imediata, a credibilidade (Pessoas) se fortalece e atrai investidores √©ticos."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Tentar corrigir o vazamento internamente e ocultar a informa√ß√£o, sem quebrar nenhuma lei.",
                        impacto: { planeta: 0, pessoas: 0, lucro: 5 }, 
                        fato: "FATO RSAC: Ocultar informa√ß√µes (Op√ß√£o B) viola o esp√≠rito da Governan√ßa. O risco de ser descoberto √© alto e o dano √† reputa√ß√£o seria irrepar√°vel."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Culpar um fornecedor externo e reter a informa√ß√£o.",
                        impacto: { planeta: 0, pessoas: -15, lucro: -15 }, 
                        fato: "FATO RSAC: Mentir (Op√ß√£o C) e culpar terceiros destr√≥i a Governan√ßa e a Reputa√ß√£o. Al√©m do dano imediato, pode levar a processos de difama√ß√£o."
                    }
                ]
            },
            {
                tema: "10. O Legado Final (Lucro/Geral)",
                pergunta: "O lucro acumulado pode ser distribu√≠do como um dividendo recorde ou reinvestido em um fundo de sustentabilidade de longo prazo para seu legado.",
                opcoes: [
                    {
                        texto: "Op√ß√£o A (RSAC Positiva): Reinvestir em um Fundo de Sustentabilidade (Legado ESG).",
                        impacto: { planeta: 10, pessoas: 10, lucro: -20 }, 
                        fato: "FATO RSAC: O **Capital de Sustentabilidade** (Op√ß√£o A) √© o reinvestimento do lucro na resili√™ncia futura da empresa, garantindo prosperidade para as pr√≥ximas gera√ß√µes."
                    },
                    {
                        texto: "Op√ß√£o B (Misto): Dividendo moderado e pequenas doa√ß√µes (Filantropia).",
                        impacto: { planeta: 5, pessoas: 5, lucro: -10 }, 
                        fato: "FATO RSAC: √â uma solu√ß√£o de compromisso (Op√ß√£o B), mas sacrifica um grande impacto de longo prazo por satisfa√ß√£o imediata de stakeholders."
                    },
                    {
                        texto: "Op√ß√£o C (RSAC Negativa): Dividendo M√°ximo, apenas para acionistas.",
                        impacto: { planeta: -5, pessoas: -5, lucro: 20 }, 
                        fato: "FATO RSAC: O foco exclusivo no lucro (Op√ß√£o C) ignora os riscos ambientais e sociais (falta de investimento em infraestrutura), tornando a empresa insustent√°vel a longo prazo."
                    }
                ]
            }
        ];

        // Estado do Jogo
        let status = {
            // AS PORCENTAGENS INICIAM EM 100% AQUI
            planeta: 100,
            pessoas: 100,
            lucro: 100,
            turno: 1,
            vitoria: 10,
            minimoParaVencer: 75,
            gameActive: false
        };

        // VARI√ÅVEIS PARA L√ìGICA DE PERGUNTAS SEQUENCIAIS E N√ÉO-REPETITIVAS
        let DILEMAS_ORDENADOS = []; // Array de √≠ndices de dilemas (ex: [3, 1, 4, 0, 2, 3, 1...])
        let INDICE_ATUAL_DILEMA = 0; // Posi√ß√£o atual no array ordenado
        
        // Refer√™ncias aos Elementos da Interface
        const elements = {
            planetaBar: document.getElementById('planeta-bar'),
            pessoasBar: document.getElementById('pessoas-bar'),
            lucroBar: document.getElementById('lucro-bar'),
            planetaValue: document.getElementById('planeta-value'),
            pessoasValue: document.getElementById('pessoas-value'),
            lucroValue: document.getElementById('lucro-value'),
            turnInfo: document.getElementById('turn-info'),
            cardContainer: document.getElementById('card-container'),
            feedbackDiv: document.getElementById('feedback'),
            gameOverScreen: document.getElementById('game-over-screen'),
            winScreen: document.getElementById('win-screen'),
            gameArea: document.getElementById('game-area')
        };
        
        // --- Fun√ß√£o para embaralhar um array (Algoritmo Fisher-Yates) ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- Fun√ß√µes de L√≥gica do Jogo ---

        function updateUI() {
            ['planeta', 'pessoas', 'lucro'].forEach(key => {
                const value = Math.max(0, Math.min(100, status[key]));
                const barElement = elements[`${key}Bar`];
                const valueElement = elements[`${key}Value`];
                
                barElement.style.width = `${value}%`;
                valueElement.textContent = `${value.toFixed(0)}%`;

                const barContainer = barElement.parentElement.parentElement;
                if (value < 25) {
                    barElement.classList.add(`low-${key}`);
                    barContainer.style.borderColor = '#e74c3c';
                } else {
                    barElement.classList.remove(`low-${key}`);
                    barContainer.style.borderColor = '';
                }
            });

            elements.turnInfo.textContent = `Turno ${status.turno} / ${status.vitoria}`;
        }

        function clamp(value) {
            return Math.max(0, Math.min(100, value));
        }

        function applyImpact(impact) {
            status.planeta = clamp(status.planeta + (impact.planeta || 0));
            status.pessoas = clamp(status.pessoas + (impact.pessoas || 0));
            status.lucro = clamp(status.lucro + (impact.lucro || 0));
        }

        // Defini√ß√£o de Eventos Aleat√≥rios (Feedback da Comunidade)
        const EVENTOS_ALEATORIOS = {
            planetaBaixo: [
                { texto: "üö® **EVENTO: Crise Ambiental!** Not√≠cias sobre polui√ß√£o h√≠drica na √°rea da f√°brica. A reputa√ß√£o cai e h√° custos de remedia√ß√£o. (-10 Lucro, -10 Pessoas).", impacto: { lucro: -10, pessoas: -10, planeta: 0 } },
                { texto: "‚ö†Ô∏è **EVENTO: Multa Ambiental Pesada!** O governo imp√µe uma multa por m√° gest√£o de res√≠duos. (-15 Lucro).", impacto: { lucro: -15, pessoas: 0, planeta: 0 } },
            ],
            pessoasBaixo: [
                { texto: "üì¢ **EVENTO: Greve Geral!** Funcion√°rios param a produ√ß√£o devido √†s m√°s condi√ß√µes de trabalho. (-15 Lucro, -5 Pessoas).", impacto: { lucro: -15, pessoas: -5, planeta: 0 } },
                { texto: "üò† **EVENTO: Protesto da Comunidade!** Moradores protestam contra a empresa. A reputa√ß√£o e confian√ßa caem. (-15 Pessoas).", impacto: { lucro: 0, pessoas: -15, planeta: 0 } },
            ],
            lucroBaixo: [
                { texto: "üìâ **EVENTO: Queda no Investimento!** Acionistas preocupados com a transpar√™ncia e desempenho reduzem o capital investido. (-10 Lucro).", impacto: { lucro: -10, pessoas: 0, planeta: 0 } },
                { texto: "‚ùå **EVENTO: Dificuldade de Empr√©stimo!** Bancos negam cr√©dito devido ao baixo desempenho financeiro. (-5 Lucro).", impacto: { lucro: -5, pessoas: 0, planeta: 0 } },
            ],
            todosAltos: [
                { texto: "üèÜ **EVENTO: Pr√™mio de Sustentabilidade!** Cobertura de m√≠dia positiva e b√¥nus nas vendas. (+10 Lucro, +5 Pessoas, +5 Planeta).", impacto: { lucro: 10, pessoas: 5, planeta: 5 } },
                { texto: "ü§ù **EVENTO: Lealdade do Consumidor!** A reputa√ß√£o exemplar impulsiona as vendas e o Lucro. (+15 Lucro).", impacto: { lucro: 15, pessoas: 0, planeta: 0 } },
            ]
        };

        function generateRandomEvent() {
            let eventText = "Tudo calmo. Nenhum evento aleat√≥rio neste turno.";
            let eventImpact = null;
            let eventType = null;

            if (status.planeta < 40 && Math.random() < 0.4) eventType = 'planetaBaixo';
            else if (status.pessoas < 40 && Math.random() < 0.4) eventType = 'pessoasBaixo';
            else if (status.lucro < 40 && Math.random() < 0.4) eventType = 'lucroBaixo';
            else if (status.planeta > 75 && status.pessoas > 75 && status.lucro > 75 && Math.random() < 0.3) eventType = 'todosAltos';

            if (eventType) {
                const events = EVENTOS_ALEATORIOS[eventType];
                const event = events[Math.floor(Math.random() * events.length)];
                eventText = event.texto;
                eventImpact = event.impacto;
                applyImpact(eventImpact);
            }
            
            return eventText;
        }

        function checkGameOver() {
            if (status.planeta <= 0 || status.pessoas <= 0 || status.lucro <= 0) {
                status.gameActive = false;
                elements.gameArea.style.display = 'none';
                elements.gameOverScreen.style.display = 'block';

                let reason = "";
                if (status.planeta <= 0) reason = "Crise Ambiental: A polui√ß√£o √© insustent√°vel. A empresa perdeu sua licen√ßa ambiental (Planeta=0%).";
                else if (status.pessoas <= 0) reason = "Crise Social: Greve geral e protestos violentos. A Reputa√ß√£o Social da empresa foi destru√≠da (Pessoas=0%).";
                else if (status.lucro <= 0) reason = "Crise Econ√¥mica/Governan√ßa: Fal√™ncia. A falta de transpar√™ncia e os custos de curto prazo levaram ao colapso (Lucro=0%).";

                elements.gameOverScreen.innerHTML = `
                    <h2>üö´ FIM DE JOGO - FALHA NO TRIP√â DA SUSTENTABILIDADE</h2>
                    <p style="font-size: 1.2em; font-weight: bold;">${reason}</p>
                    <p>Voc√™ n√£o conseguiu equilibrar o **Triple Bottom Line**.</p>
                    <p>Tente novamente para provar que a RSAC √© um modelo de sucesso!</p>
                    <button onclick="window.location.reload()" class="next-turn-button" style="background-color: #f1c40f; color: #333;">Recome√ßar</button>
                `;
                return true;
            }
            return false;
        }

        function checkWin() {
            if (status.turno > status.vitoria) {
                if (status.planeta >= status.minimoParaVencer && status.pessoas >= status.minimoParaVencer && status.lucro >= status.minimoParaVencer) {
                    status.gameActive = false;
                    elements.gameArea.style.display = 'none';
                    elements.winScreen.style.display = 'block';
                    elements.winScreen.innerHTML = `
                        <h2>ü•≥ VIT√ìRIA! - GESTOR SUSTENT√ÅVEL!</h2>
                        <p style="font-size: 1.5em; font-weight: bold;">Voc√™ sobreviveu por ${status.vitoria} Turnos com excel√™ncia!</p>
                        <p>Parab√©ns! Voc√™ provou que √© poss√≠vel prosperar (**Lucro: ${status.lucro.toFixed(0)}%**) ao mesmo tempo em que cuida das **Pessoas** (**${status.pessoas.toFixed(0)}%**) e do **Planeta** (**${status.planeta.toFixed(0)}%**).</p>
                        <p>A **Responsabilidade Social/Ambiental Corporativa (RSAC)** √© o caminho para um neg√≥cio de sucesso no futuro.</p>
                        <button onclick="window.location.reload()" class="next-turn-button">Jogar Novamente</button>
                    `;
                } else {
                    status.gameActive = false;
                    elements.gameArea.style.display = 'none';
                    elements.gameOverScreen.style.display = 'block';
                    elements.gameOverScreen.style.backgroundColor = '#d35400';
                    elements.gameOverScreen.innerHTML = `
                        <h2>‚ö†Ô∏è JOGO CONCLU√çDO - META N√ÉO ATINGIDA</h2>
                        <p style="font-size: 1.2em; font-weight: bold;">Voc√™ sobreviveu, mas n√£o alcan√ßou a meta de ${status.minimoParaVencer}% em todos os pilares.</p>
                        <p>O equil√≠brio √© essencial: o sucesso sustent√°vel exige altos n√≠veis nos 3 pilares da RSAC. Mantenha o foco!</p>
                        <button onclick="window.location.reload()" class="next-turn-button" style="background-color: #f1c40f; color: #333;">Recome√ßar</button>
                    `;
                }
                return true;
            }
            return false;
        }

        function startTurn() {
            if (!status.gameActive) return;

            elements.cardContainer.innerHTML = '';
            elements.feedbackDiv.style.display = 'none';
            elements.feedbackDiv.innerHTML = '';

            if (checkWin()) return;

            // L√≥gica de Sele√ß√£o Sequencial/N√£o-Repetitiva
            
            // 1. Se todos os dilemas foram usados, reembaralha para o pr√≥ximo ciclo
            if (INDICE_ATUAL_DILEMA >= DILEMAS_ORDENADOS.length) {
                DILEMAS_ORDENADOS = Array.from({ length: DILEMAS.length }, (_, i) => i);
                shuffleArray(DILEMAS_ORDENADOS); 
                INDICE_ATUAL_DILEMA = 0;
            }

            // 2. Obt√©m o √≠ndice do dilema para o turno atual
            const currentDilemmaIndex = DILEMAS_ORDENADOS[INDICE_ATUAL_DILEMA];
            const currentDilemma = DILEMAS[currentDilemmaIndex];
            
            // 3. Prepara para o pr√≥ximo dilema na ordem
            INDICE_ATUAL_DILEMA++; 
            
            let cardHTML = `
                <h2>üÉè Dilema do Turno ${status.turno}: ${currentDilemma.tema}</h2>
                <p style="font-weight: bold; font-size: 1.1em;">${currentDilemma.pergunta}</p>
                <p>Escolha uma op√ß√£o:</p>
            `;

            // Renderiza as op√ß√µes
            currentDilemma.opcoes.forEach((option, index) => {
                cardHTML += `
                    <button class="option-button" onclick="handleDecision(${status.turno}, ${currentDilemmaIndex}, ${index})">
                        ${option.texto}
                    </button>
                `;
            });

            elements.cardContainer.innerHTML = cardHTML;
            updateUI();
        }

        function handleDecision(turno, dilemmaIndex, optionIndex) {
            // Impede cliques m√∫ltiplos ou de turnos passados
            if (turno !== status.turno || !status.gameActive) return;

            const chosenDilemma = DILEMAS[dilemmaIndex];
            if (!chosenDilemma) return; 

            const decision = chosenDilemma.opcoes[optionIndex];
            
            // 1. Aplica o impacto da decis√£o
            applyImpact(decision.impacto);

            // 2. Gera e aplica o evento aleat√≥rio (feedback)
            const eventText = generateRandomEvent();
            
            // 3. Verifica Game Over
            if (checkGameOver()) {
                updateUI();
                return;
            }

            // 4. Exibe o Feedback
            elements.feedbackDiv.style.display = 'block';
            let feedbackHTML = `
                <h3>‚úÖ Decis√£o Tomada (Turno ${status.turno})</h3>
                <p>Voc√™ escolheu: **${decision.texto.replace(/<[^>]*>?/gm, '')}**</p>
                <div class="educational-fact">
                    <strong>Conte√∫do Educacional:</strong> ${decision.fato}
                </div>
                <h3>üì¢ Feedback da Comunidade/Eventos</h3>
                <p>${eventText}</p>
                <p style="font-weight: bold;">Seu Status Ap√≥s o Turno ${status.turno}:</p>
                <ul>
                    <li>üü¢ Planeta: ${status.planeta.toFixed(0)}%</li>
                    <li>üîµ Pessoas: ${status.pessoas.toFixed(0)}%</li>
                    <li>üí∞ Lucro: ${status.lucro.toFixed(0)}%</li>
                </ul>
            `;
            elements.feedbackDiv.innerHTML = feedbackHTML;

            // 5. Prepara para o pr√≥ximo turno
            status.turno++;
            
            elements.cardContainer.innerHTML = `
                <h2>Pr√≥ximo Passo</h2>
                <p style="text-align: center;">O **Ano Fiscal** (Turno ${status.turno - 1}) terminou. Clique abaixo para iniciar o pr√≥ximo ciclo.</p>
                <button onclick="startTurn()" class="next-turn-button">Avan√ßar para Turno ${status.turno}</button>
            `;
            
            updateUI();
        }

        function startGame() {
            status.gameActive = true;
            // ATUALIZA√á√ÉO: Inicia em 100%
            status.planeta = 100;
            status.pessoas = 100;
            status.lucro = 100;
            status.turno = 1;
            elements.gameOverScreen.style.display = 'none';
            elements.winScreen.style.display = 'none';
            elements.gameArea.style.display = 'block';

            // Inicializa a ordem dos dilemas (10 dilemas para 10 turnos)
            DILEMAS_ORDENADOS = Array.from({ length: DILEMAS.length }, (_, i) => i);
            shuffleArray(DILEMAS_ORDENADOS);
            INDICE_ATUAL_DILEMA = 0;
            
            startTurn();
        }

        // Inicializa a UI ao carregar a p√°gina
        updateUI();
    </script>
</body>
</html>
